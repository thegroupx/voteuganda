<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Community Ballot</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  
  
  <!-- Schema Markup (JSON-LD) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Event",
  "name": "Ugandan Online Community Election",
  "description": "We invite all Ugandans to participate in a transparent and inclusive online election. Cast your vote and make your voice heard.",
  "image": "https://raw.githubusercontent.com/thegroupx/voteuganda/main/cand.jpg",
  "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode",
  "eventStatus": "https://schema.org/EventScheduled",
  "location": {
    "@type": "VirtualLocation",
    "url": "https://thegroupx.github.io/voteuganda/"
  },
  "startDate": "2025-09-05T09:00:00+03:00",
  "endDate": "2025-09-30T23:59:00+03:00",
  "organizer": {
    "@type": "Organization",
    "name": "Uganda Community Voting",
    "url": "https://thegroupx.github.io/voteuganda/"
  }
}
</script>

<!-- Twitter Card Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Ugandan Online Community Election">
<meta name="twitter:description" content="All Ugandans are invited to participate in an inclusive online election. Cast your vote today.">
<meta name="twitter:image" content="https://raw.githubusercontent.com/thegroupx/voteuganda/main/cand.jpg">
<meta name="twitter:site" content="@YourTwitterHandle">
<meta name="twitter:creator" content="@YourTwitterHandle">

<!-- Open Graph Meta Tags -->
<meta property="og:type" content="website">
<meta property="og:title" content="Ugandan Online Community Election">
<meta property="og:description" content="All Ugandans are invited to participate in an inclusive online election. Cast your vote today.">
<meta property="og:image" content="https://raw.githubusercontent.com/thegroupx/voteuganda/main/cand.jpg">
<meta property="og:url" content="https://thegroupx.github.io/voteuganda/">
<meta property="og:site_name" content="Uganda Community Voting">
  
  <style>
    ..candidate-img {
  width: 100%;
  height: auto;      /* keep natural height */
  border-radius: 1rem;
  object-fit: contain; /* optional: makes sure image is never stretched */
}
    
    .symbol { width: 32px; height: 32px; position: absolute; top: 8px; right: 8px; }
    .card { position: relative; overflow: hidden; border-radius: 1rem; cursor: pointer; transition: transform 0.2s; }
    .card:hover { transform: scale(1.03); }
    .progress-bar { height: 1rem; border-radius: 0.5rem; background-color: #e5e7eb; overflow: hidden; }
    .progress-fill { height: 100%; background-color: #3b82f6; text-align: right; padding-right: 0.5rem; color: white; font-size: 0.75rem; line-height: 1rem; }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
<div class="max-w-3xl mx-auto p-4 sm:p-6">
  <header class="mb-6 text-center">
    <h1 class="text-2xl sm:text-3xl font-bold">Community Ballot</h1>
    <p class="text-gray-600">Select one candidate and submit your vote.</p>
  </header>

  <form id="ballotForm" class="grid grid-cols-1 sm:grid-cols-2 gap-4"></form>

  <div class="mt-6 flex items-center justify-between">
    <button id="submitBtn" class="px-6 py-3 rounded-2xl bg-blue-600 text-white font-semibold shadow hover:bg-blue-700 disabled:opacity-50" disabled>
      Submit Vote
    </button>
    <button id="viewResults" type="button" class="px-4 py-2 bg-gray-200 rounded-2xl hover:bg-gray-300">
      View Results
    </button>
  </div>

  <p id="status" class="mt-4 text-sm text-gray-700"></p>

  <div id="results" class="mt-6 hidden">
    <h2 class="text-xl font-semibold mb-3">Live Results</h2>
    <ul id="resultsList" class="space-y-2"></ul>
  </div>
</div>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyDRaq_j5SdX4Bc-AzuVvaGYU4zE7GRKMS8",
    authDomain: "vote-e5fad.firebaseapp.com",
    databaseURL: "https://vote-e5fad-default-rtdb.firebaseio.com",
    projectId: "vote-e5fad",
    storageBucket: "vote-e5fad.appspot.com",
    messagingSenderId: "350589656939",
    appId: "1:350589656939:web:5b844ff6c745169d6df62e"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Candidate data (GitHub raw URLs)
  const candidates = [
    { id: 1, name: 'Mugisha Muntu', img: 'https://raw.githubusercontent.com/thegroupx/voteuganda/main/cand1.jpg', symbol: 'https://raw.githubusercontent.com/thegroupx/voteuganda/main/sym1.jpeg' },
    { id: 2, name: 'Nancy Kalembe', img: 'https://raw.githubusercontent.com/thegroupx/voteuganda/main/cand2.jpg', symbol: 'https://raw.githubusercontent.com/thegroupx/voteuganda/main/sym2.jpeg' },
    { id: 3, name: 'Nathan Nandala Mafabi', img: 'https://raw.githubusercontent.com/thegroupx/voteuganda/main/cand3.jpg', symbol: 'https://raw.githubusercontent.com/thegroupx/voteuganda/main/sym3.jpeg' },
    { id: 4, name: 'Robert Kyagulanyi Ssentamu', img: 'https://raw.githubusercontent.com/thegroupx/voteuganda/main/cand4.jpg', symbol: 'https://raw.githubusercontent.com/thegroupx/voteuganda/main/sym4.jpeg' },
    { id: 5, name: 'Yoweri Kaguta Museveni', img: 'https://raw.githubusercontent.com/thegroupx/voteuganda/main/cand5.jpg', symbol: 'https://raw.githubusercontent.com/thegroupx/voteuganda/main/sym5.jpeg' }
  ];

  const form = document.getElementById('ballotForm');
  const submitBtn = document.getElementById('submitBtn');
  const statusEl = document.getElementById('status');
  const resultsBox = document.getElementById('results');
  const resultsList = document.getElementById('resultsList');

  function getFingerprint() {
    return navigator.userAgent + screen.width + screen.height;
  }

  // Render candidates
  function renderCandidates() {
    form.innerHTML = '';
    candidates.forEach(c => {
      const card = document.createElement('label');
      card.className = 'card bg-white shadow p-0 relative';
      card.innerHTML = `
        <div class="relative">
          <img src="${c.img}" class="candidate-img" onerror="this.src='fallback.png'" />
          <img src="${c.symbol}" class="symbol" onerror="this.style.display='none'" />
        </div>
        <div class="p-4 flex items-center justify-between">
          <p class="font-semibold">${c.name}</p>
          <input type="radio" name="candidate" value="${c.id}" class="w-5 h-5" />
        </div>
      `;
      form.appendChild(card);
    });
  }

  renderCandidates();

  // Enable submit on selection
  form.addEventListener('change', () => {
    submitBtn.disabled = !document.querySelector('input[name="candidate"]:checked');
  });

  // Prevent multiple votes
  if (localStorage.getItem('ballot_voted') === '1') {
    submitBtn.disabled = true;
    statusEl.textContent = 'You have already voted on this device.';
  }

  // Submit vote
  submitBtn.addEventListener('click', () => {
    const selected = document.querySelector('input[name="candidate"]:checked');
    if (!selected) return;

    submitBtn.disabled = true;
    statusEl.textContent = 'Submitting your vote...';

    const candidateId = selected.value;
    const fp = getFingerprint();

    db.ref('votes/' + candidateId + '/' + fp).set(true)
      .then(() => {
        localStorage.setItem('ballot_voted', '1');
        statusEl.textContent = '✅ Vote recorded. Thank you!';
        loadResults();
      })
      .catch(err => {
        submitBtn.disabled = false;
        statusEl.textContent = '❌ ' + err.message;
      });
  });

  // Load results with percentages
  function loadResults() {
    db.ref('votes').once('value').then(snapshot => {
      const votes = snapshot.val() || {};
      resultsList.innerHTML = '';

      let totalVotes = 0;
      candidates.forEach(c => {
        totalVotes += votes[c.id] ? Object.keys(votes[c.id]).length : 0;
      });

      candidates.forEach(c => {
        let count = votes[c.id] ? Object.keys(votes[c.id]).length : 0;
        let percent = totalVotes > 0 ? ((count / totalVotes) * 100).toFixed(1) : 0;

        const li = document.createElement('li');
        li.className = 'bg-white rounded-xl p-3 shadow';

        li.innerHTML = `
          <div class="flex justify-between items-center mb-1">
            <span class="font-semibold text-blue-600">${c.name}</span>
            <span class="text-gray-800">${count} votes (${percent}%)</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: ${percent}%">${percent}%</div>
          </div>
        `;
        resultsList.appendChild(li);
      });

      resultsBox.classList.remove('hidden');
    });
  }

  // View results button
  document.getElementById('viewResults').addEventListener('click', loadResults);

  // Initial load
  loadResults();
</script>
</body>
</html> 
 
 
 
 
